(function($){
	"use strict";

	if( typeof $.fn == 'undefined' ) return;

	// http://localhost/flights-search/?origin=DAC&destination=DXB&depart=2024-01-18&return=&adults=1&children=0&infants=0&type=single&search=avira

	$(document).ready(function(){

		var url = new URL( window.location.href );
		var params = url.searchParams;
		var search = params.get('search');
		console.log( search );
		if( search=='avira' ){

			var type = params.get('type');

			var infants = params.get('infants') || 0,
				children = params.get('children') || 0,
				adults = params.get('adults') || 1,
				flightClass = params.get('class') || 'Economy';

			if( type == 'single' ){

				var origin = params.get('origin'),
					destination = params.get('destination'),
					departDate = params.get('depart'),
					returnDate = params.get('return');

				$.ajax({
					'url': xmlagencyltd_search_results_params.ajax_url.replaceAll('##AJAX##', 'xmlagencyltd_avira'),
					'method' : 'GET',
					'dataType' : 'json',
					'data': {
							'type' : type,
							'origin' : origin,
							'destination' : destination,
							'depart' : departDate,
							'return' : returnDate,
							'adults' : adults,
							'children' : children,
							'infants' : infants,
							'class' : flightClass,
						},
					'beforeSend' : function(){
						// show loading
					},
					'error' : function(xhr){
						$('.xmlagency-flight-search-results').html(xmlagencyltd_search_results_params.data);
					},
					'success' : function(data){
						if(typeof data.data !='undefined' ){
							$('.xmlagency-flight-search-results').html(data.data);
						}
					},
					'complete' : function(xhr){
						console.log( xhr );
						setTimeout(function(){
							// finish loading
						}, 300);
					}
				});

			}else if ( type == 'multi' ){

			}

		}else if( search== 'hotels' ){
			
		}else{

		}

	});

})(window.jQuery);

